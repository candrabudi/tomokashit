import{d as R,ee as D,bn as Y,V as q,k as n,a6 as j,dY as I,p as C,cL as G,bp as H,cF as K,r as O,x as g,o as u,c,f as B,w as x,F as w,g as E,b as r,s as L,n as J,v as Q,ae as W}from"./index-QJ1DP7so.js";import{g as X,b as Z,a as ee}from"./index.vue_vue_type_script_setup_true_lang-DABSSxT0.js";import{_ as ae}from"./index.vue_vue_type_style_index_0_lang-rlqotkuX.js";import{d as te}from"./debounce-CjT1fh4c.js";const re={class:"relative"},se={key:0,class:"sticky bottom-0 right-0 z-11 flex justify-end bg-body py-10"},ue=R({__name:"index",props:{type:{type:Number},sportId:{type:Number},refreshInterval:{type:Number,default:60*1e3},leagueIds:{type:Array},orderBy:{type:Number,default:D.time},beginTime:{type:Number,default:null},endTime:{type:Number,default:null},allCollapse:{type:Boolean,default:!1},addToParlay:{type:Boolean,default:!0},immediate:{type:Boolean,default:!0}},setup(N,{expose:k}){const t=N,v=Y();let m,d=!1;const f=q({type:n(()=>t.type),orderBy:n(()=>t.orderBy),sportId:n(()=>t.sportId),leagueIds:n(()=>t.leagueIds),beginTime:n(()=>t.beginTime),endTime:n(()=>t.endTime),pageSize:20,oddsType:null,isPC:!0}),{data:T,loading:S,finished:z,empty:M,error:P,errorInfo:U,pagination:o,reload:A,run:b}=j(C,{params:f,listKey:"records",immediate:t.immediate,onBefore:async a=>(p(),a.oddsType=await v.getUpMapValue(I.FB,"oddsType"),a),onSuccess(){_()}}),y=n(()=>X(T.value));function p(){m&&window.clearTimeout(m)}function _(){p(),!d&&(m=window.setTimeout(()=>{F().then(()=>{_()})},t.refreshInterval))}G(()=>{d=!0,p()}),H(()=>{d&&(d=!1,_())}),K(()=>{d=!0,p()});async function F(){const a=[];return a.push(C({...f,oddsType:await v.getUpMapValue(I.FB,"oddsType"),current:o.current})),Promise.all(a).then(l=>{const i=[];l.forEach(e=>{e.success&&(i.push(...e.data.records),o.total=e.data.total)}),T.value=i})}const s=O([]);function V(a){s.value.includes(a)?s.value=s.value.filter(l=>l!==a):s.value.push(a)}return g(()=>t.allCollapse,()=>{t.allCollapse?s.value=y.value.map(a=>a.groupId):s.value=[]}),g(()=>y.value,(a,l)=>{if(t.allCollapse){const i=l.map(e=>e.groupId).filter(e=>!s.value.includes(e));s.value=a.map(e=>e.groupId).filter(e=>!i.includes(e))}},{deep:!0}),g(f,te(()=>{s.value=[],A()},100)),k({refresh:()=>{b(o.current)}}),(a,l)=>{const i=W;return u(),c("div",re,[B(i,{loading:r(S),finished:r(z),empty:r(M),error:r(P),"error-info":r(U)},{default:x(()=>[(u(!0),c(w,null,E(r(y),e=>(u(),L(Z,{key:e.groupId,class:"mb-10",title:e.na,"icon-url":e.lurl,"sport-id":t.sportId,expand:!r(s).includes(e.groupId),onExpandChange:h=>V(e.groupId)},{default:x(()=>[(u(!0),c(w,null,E(e.list,(h,$)=>(u(),L(ee,{key:h.id,class:J({"mb-10":$!==0}),"match-data":h,"add-to-parlay":t.addToParlay},null,8,["class","match-data","add-to-parlay"]))),128))]),_:2},1032,["title","icon-url","sport-id","expand","onExpandChange"]))),128))]),_:1},8,["loading","finished","empty","error","error-info"]),r(o).total>r(o).pageSize?(u(),c("div",se,[B(ae,{current:r(o).current,"page-size":r(o).pageSize,total:r(o).total,"onUpdate:current":r(b)},null,8,["current","page-size","total","onUpdate:current"])])):Q("",!0)])}}});export{ue as _};
